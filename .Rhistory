title("Leaf Area Index")
dev.off()
# Chunk 24
relative_humidity <- raster("Data/Environmental_data/Relative Humidity/RH_month_raster/rh_ann/prj.adf")
#relative_humidity <- projectRaster(relative_humidity, crs = project_crs)
relative_humidity_cut <- mask(relative_humidity, chosen_map)
relative_humidity_cut <- crop(relative_humidity_cut, chosen_map)
relative_humidity_snails <- mask(relative_humidity, snail_island_shp)
relative_humidity_snails <- crop(relative_humidity_snails, snail_island_shp)
png(filename=paste("Outputs/Env_output_plots/relative_humidity_", chosen_island, ".png", sep=""))
plot(relative_humidity_cut)
title("Relative Humidity")
dev.off()
# Chunk 25
if (!file.exists(paste("Data/Environmental_data/Slope Degrees/Tif/LH20_SlpD_220.Rdata", sep=""))){
slope_degrees <- raster("Data/Environmental_data/Slope Degrees/Tif/LH20_SlpD_220.tif")
slope_degrees <- projectRaster(slope_degrees, crs=project_crs)
save(slope_degrees, file = paste("Data/Environmental_data/Slope Degrees/Tif/LH20_SlpD_220.Rdata", sep=""))
slope_degrees_cut <- crop(slope_degrees, chosen_map)
slope_degrees_cut <- mask(slope_degrees_cut, chosen_map)
slope_degrees_snails <- crop(slope_degrees, snail_island_shp)
slope_degrees_snails <- mask(slope_degrees_snails, snail_island_shp)
rm(slope_degrees)
gc()
} else {
load(paste("Data/Environmental_data/Slope Degrees/Tif/LH20_SlpD_220.Rdata", sep=""))
slope_degrees_cut <- crop(slope_degrees, chosen_map)
slope_degrees_cut <- mask(slope_degrees_cut, chosen_map)
slope_degrees_snails <- crop(slope_degrees, snail_island_shp)
slope_degrees_snails <- mask(slope_degrees_snails, snail_island_shp)
rm(slope_degrees)
gc()
}
png(filename=paste("Outputs/Env_output_plots/slope_degrees_", chosen_island, ".png", sep=""))
plot(slope_degrees_cut)
title("Slope Degrees")
dev.off()
# Chunk 26
if (!file.exists(paste("Data/Environmental_data/Slope Percent Rise/Tif/LH20_SlpP_220.Rdata", sep=""))){
slope_percent_rise <- raster("Data/Environmental_data/Slope Percent Rise/Tif/LH20_SlpP_220.tif")
slope_percent_rise <- projectRaster(slope_percent_rise, crs=project_crs)
save(slope_percent_rise, file = paste("Data/Environmental_data/Slope Percent Rise/Tif/LH20_SlpP_220.Rdata", sep=""))
slope_percent_rise_cut <- crop(slope_percent_rise, chosen_map)
slope_percent_rise_cut <- mask(slope_percent_rise_cut, chosen_map)
slope_percent_rise_snails <- crop(slope_percent_rise, snail_island_shp)
slope_percent_rise_snails <- mask(slope_percent_rise_snails, snail_island_shp)
rm(slope_percent_rise)
gc()
} else {
load(paste("Data/Environmental_data/Slope Percent Rise/Tif/LH20_SlpP_220.Rdata", sep=""))
slope_percent_rise_cut <- crop(slope_percent_rise, chosen_map)
slope_percent_rise_cut <- mask(slope_percent_rise_cut, chosen_map)
slope_percent_rise_snails <- crop(slope_percent_rise, snail_island_shp)
slope_percent_rise_snails <- mask(slope_percent_rise_snails, snail_island_shp)
rm(slope_percent_rise)
gc()
}
png(filename=paste("Outputs/Env_output_plots/slope_percent_rise_", chosen_island, ".png", sep=""))
plot(slope_percent_rise_cut)
title("Slope Percent Rise")
dev.off()
# Chunk 28
soil_evaporation <- raster("Data/Environmental_data/Soil Evaporation/mm/SoilEvaporation_mm_month_raster/soil_evaporation_mm_month_raster/se_mm_ann/prj.adf")
#soil_evaporation <- projectRaster(soil_evaporation, crs = project_crs)
soil_evaporation_cut <- mask(soil_evaporation, chosen_map)
soil_evaporation_cut <- crop(soil_evaporation_cut, chosen_map)
soil_evaporation_snails <- mask(soil_evaporation, snail_island_shp)
soil_evaporation_snails <- crop(soil_evaporation_snails, snail_island_shp)
png(filename=paste("Outputs/Env_output_plots/soil_evaporation_", chosen_island, ".png", sep=""))
plot(soil_evaporation_cut)
title("Soil Evaporation")
dev.off()
# Chunk 29
if (!file.exists(paste("Data/Environmental_data/Soil Fertility Class/FertilityClass_State_wgs84.shp", sep=""))){
soil_fertility_class <- vect("Data/Environmental_data/Soil Fertility Class/FertilityClass_State.shp")
soil_fertility_class <- project(soil_fertility_class, project_crs)
writeVector(soil_fertility_class, paste("Data/Environmental_data/Soil Fertility Class/FertilityClass_State_wgs84.shp", sep=""), filetype="ESRI Shapefile")
soil_fertility_class_cut <- crop(soil_fertility_class, chosen_map)
soil_fertility_class_snails <- crop(soil_fertility_class, snail_island_shp)
rm(soil_fertility_class)
gc()
} else {
soil_fertility_class <- vect(paste("Data/Environmental_data/Soil Fertility Class/FertilityClass_State_wgs84.shp", sep=""))
soil_fertility_class_cut <- crop(soil_fertility_class, chosen_map)
soil_fertility_class_snails <- crop(soil_fertility_class, snail_island_shp)
rm(soil_fertility_class)
gc()
}
ncols <- length(unique(soil_fertility_class_cut$FertClass))
cols=sample(col_vector_random, ncols)
soil_colors <- cols[as.factor(soil_fertility_class_cut$FertClass)]
png(filename=paste("Outputs/Env_output_plots/soil_fertility_class_", chosen_island, ".png", sep=""))
plot(soil_fertility_class_cut, col=soil_colors, border=NA)
title("Soil Fertility Class")
legend("bottomright",   # location of legend
legend=unique(soil_fertility_class_cut$FertClass),
fill=cols)
dev.off()
# Chunk 30
if (!file.exists(paste("Data/Environmental_data/Soil Nutrient Holding Capacity/CEC_State_wgs84.shp", sep=""))){
soil_nutrient_holding_capacity <- vect("Data/Environmental_data/Soil Nutrient Holding Capacity/CEC_State.shp")
soil_nutrient_holding_capacity <- project(soil_nutrient_holding_capacity, project_crs)
writeVector(soil_nutrient_holding_capacity, paste("Data/Environmental_data/Soil Nutrient Holding Capacity/CEC_State_wgs84.shp", sep=""), filetype="ESRI Shapefile")
soil_nutrient_holding_capacity_cut <- crop(soil_nutrient_holding_capacity, chosen_map)
soil_nutrient_holding_capacity_snails <- crop(soil_nutrient_holding_capacity, snail_island_shp)
rm(soil_nutrient_holding_capacity)
gc()
} else {
soil_nutrient_holding_capacity <- vect(paste("Data/Environmental_data/Soil Nutrient Holding Capacity/CEC_State_wgs84.shp", sep=""))
soil_nutrient_holding_capacity_cut <- crop(soil_nutrient_holding_capacity, chosen_map)
soil_nutrient_holding_capacity_snails <- crop(soil_nutrient_holding_capacity, snail_island_shp)
rm(soil_nutrient_holding_capacity)
gc()
}
ncols <- length(unique(soil_nutrient_holding_capacity_cut$CECmod_rep) - 1)
cols <- col_vector_ordered(ncols)
#change 0 to gray since 0 is N/A
cols <- c("gray", cols)
soil_colors <- cols[as.factor(soil_nutrient_holding_capacity_cut$CECmod_rep)]
png(filename=paste("Outputs/Env_output_plots/soil_nutrient_holding_capacity_", chosen_island, ".png", sep=""))
plot(soil_nutrient_holding_capacity_cut, col=soil_colors, border=NA)
title("Soil Nutrient Holding Capacity")
legend <- c("Not Available", "Low", "Moderate", "High", "Very High")
cols <- col_vector_ordered(length(legend) - 1)
cols <- c("gray", cols)
legend("bottomright",   # location of legend
legend=legend,
fill=cols)
dev.off()
# Chunk 32
if (!file.exists(paste("Data/Environmental_data/Soil Organic Matter/OrganicMatter_State_wgs84.shp", sep=""))){
soil_organic_matter <- vect("Data/Environmental_data/Soil Organic Matter/OrganicMatter_State.shp")
soil_organic_matter <- project(soil_organic_matter, project_crs)
writeVector(soil_organic_matter, paste("Data/Environmental_data/Soil Organic Matter/OrganicMatter_State_wgs84.shp", sep=""), filetype="ESRI Shapefile")
soil_organic_matter_cut <- crop(soil_organic_matter, chosen_map)
soil_organic_matter_snails <- crop(soil_organic_matter, snail_island_shp)
rm(soil_organic_matter)
gc()
} else {
soil_organic_matter <- vect(paste("Data/Environmental_data/Soil Organic Matter/OrganicMatter_State_wgs84.shp", sep=""))
soil_organic_matter_cut <- crop(soil_organic_matter, chosen_map)
soil_organic_matter_snails <- crop(soil_organic_matter, snail_island_shp)
rm(soil_organic_matter)
gc()
}
ncols <- length(unique(soil_organic_matter_cut$OM_rep) - 1)
cols <- col_vector_ordered(ncols)
#change 0 to gray since 0 is N/A
cols <- c("gray", cols)
soil_colors <- cols[as.factor(soil_organic_matter_cut$OM_rep)]
png(filename=paste("Outputs/Env_output_plots/soil_organic_matter_", chosen_island, ".png", sep=""))
plot(soil_organic_matter_cut, col=soil_colors, border=NA)
title("Soil Organic Matter")
legend <- c("Not Available", "Low", "Moderate", "High", "Very High")
cols <- col_vector_ordered(length(legend) - 1)
cols <- c("gray", cols)
legend("bottomright",   # location of legend
legend=legend,
fill=cols)
dev.off()
# Chunk 33
if (!file.exists(paste("Data/Environmental_data/Soil pH/pH_State_wgs84.shp", sep=""))){
soil_ph <- vect("Data/Environmental_data/Soil pH/pH_State.shp")
soil_ph <- project(soil_ph, project_crs)
writeVector(soil_ph, paste("Data/Environmental_data/Soil pH/pH_State_wgs84.shp", sep=""), filetype="ESRI Shapefile")
soil_ph_cut <- crop(soil_ph, chosen_map)
soil_ph_snails <- crop(soil_ph, snail_island_shp)
rm(soil_ph)
gc()
} else {
soil_ph <- vect(paste("Data/Environmental_data/Soil pH/pH_State_wgs84.shp", sep=""))
soil_ph_cut <- crop(soil_ph, chosen_map)
soil_ph_snails <- crop(soil_ph, snail_island_shp)
rm(soil_ph)
gc()
}
ncols <- length(unique(soil_ph_cut$pHmod_rep) - 1)
cols <- col_vector_ordered(ncols)
#change 0 to gray since 0 is N/A
cols <- c("gray", cols)
soil_colors <- cols[as.factor(soil_ph_cut$pHmod_rep)]
png(filename=paste("Outputs/Env_output_plots/soil_ph_", chosen_island, ".png", sep=""))
plot(soil_ph_cut, col=soil_colors, border=NA)
title("Soil pH")
legend <- c("Not Available", "Acidic", "Slightly Acidic to Neutral", "Slightly Alkaline to Alkaline")
cols <- col_vector_ordered(length(legend) - 1)
cols <- c("gray", cols)
legend("bottomright",   # location of legend
legend=legend,
fill=cols)
dev.off()
# Chunk 34
if (!file.exists(paste("Data/Environmental_data/Soil Shrink and Swell/ShrinkSwell_State_wgs84.shp", sep=""))){
soil_shrink_and_swell <- vect("Data/Environmental_data/Soil Shrink and Swell/ShrinkSwell_State.shp")
soil_shrink_and_swell <- project(soil_shrink_and_swell, project_crs)
writeVector(soil_shrink_and_swell, paste("Data/Environmental_data/Soil Shrink and Swell/ShrinkSwell_State_wgs84.shp", sep=""), filetype="ESRI Shapefile")
soil_shrink_and_swell_cut <- crop(soil_shrink_and_swell, chosen_map)
soil_shrink_and_swell_snails <- crop(soil_shrink_and_swell, snail_island_shp)
rm(soil_shrink_and_swell)
gc()
} else {
soil_shrink_and_swell <- vect(paste("Data/Environmental_data/Soil Shrink and Swell/ShrinkSwell_State_wgs84.shp", sep=""))
soil_shrink_and_swell_cut <- crop(soil_shrink_and_swell, chosen_map)
soil_shrink_and_swell_snails <- crop(soil_shrink_and_swell, snail_island_shp)
rm(soil_shrink_and_swell)
gc()
}
ncols <- length(unique(soil_shrink_and_swell_cut$COLE_rep))
cols <- col_vector_ordered(ncols)
soil_colors <- cols[as.factor(soil_shrink_and_swell_cut$COLE_rep)]
png(filename=paste("Outputs/Env_output_plots/soil_shrink_and_swell_", chosen_island, ".png", sep=""))
plot(soil_shrink_and_swell_cut, col=soil_colors, border=NA)
title("Soil Shrink and Swell")
legend <- c("Low", "Moderate", "High", "Very High")
cols <- col_vector_ordered(length(legend))
legend("bottomright",   # location of legend
legend=legend,
fill=cols)
dev.off()
# Chunk 35
if (!file.exists(paste("Data/Environmental_data/Soil Water Permeability/WaterPermeability_State_wgs84.shp", sep=""))){
soil_water_permeability <- vect("Data/Environmental_data/Soil Water Permeability/WaterPermeability_State.shp")
soil_water_permeability <- project(soil_water_permeability, project_crs)
writeVector(soil_water_permeability, paste("Data/Environmental_data/Soil Water Permeability/WaterPermeability_State_wgs84.shp", sep=""), filetype="ESRI Shapefile")
soil_water_permeability_cut <- crop(soil_water_permeability, chosen_map)
soil_water_permeability_snails <- crop(soil_water_permeability, snail_island_shp)
rm(soil_water_permeability)
gc()
} else {
soil_water_permeability <- vect(paste("Data/Environmental_data/Soil Water Permeability/WaterPermeability_State_wgs84.shp", sep=""))
soil_water_permeability_cut <- crop(soil_water_permeability, chosen_map)
soil_water_permeability_snails <- crop(soil_water_permeability, snail_island_shp)
rm(soil_water_permeability)
gc()
}
ncols <- length(unique(soil_water_permeability_cut$Ksat_rep) - 1)
cols <- col_vector_ordered(ncols)
#change 0 to gray since 0 is N/A
cols <- c("gray", cols)
soil_colors <- cols[as.factor(soil_water_permeability_cut$Ksat_rep)]
png(filename=paste("Outputs/Env_output_plots/soil_water_permeability_", chosen_island, ".png", sep=""))
plot(soil_water_permeability_cut, col=soil_colors, border=NA)
title("Soil Water Permeablity")
legend <- c("Not Available", "Slow", "Moderate", "Fast", "Very Fast")
cols <- col_vector_ordered(length(legend) - 1)
cols <- c("gray", cols)
legend("bottomright",   # location of legend
legend=legend,
fill=cols)
dev.off()
# Chunk 36
#BEFORE
if (!file.exists(paste("Data/Environmental_data/TNC Ecosystems Before and Current/Before_Ecosystems_wgs84.shp", sep=""))){
tnc_before <- vect("Data/Environmental_data/TNC Ecosystems Before and Current/Before_Ecosystems.shp")
tnc_before <- project(tnc_before, project_crs)
writeVector(tnc_before, paste("Data/Environmental_data/TNC Ecosystems Before and Current/Before_Ecosystems_wgs84.shp", sep=""), filetype="ESRI Shapefile")
tnc_before_cut <- crop(tnc_before, chosen_map)
tnc_before_snails <- crop(tnc_before, snail_island_shp)
rm(tnc_before)
gc()
} else {
tnc_before <- vect(paste("Data/Environmental_data/TNC Ecosystems Before and Current/Before_Ecosystems_wgs84.shp", sep=""))
tnc_before_cut <- crop(tnc_before, chosen_map)
tnc_before_snails <- crop(tnc_before, snail_island_shp)
rm(tnc_before)
gc()
}
tnc_ecosystems <- c("Lowland Dry Forest & Shrubland", "Lowland Dry Shrubland & Grassland", "Lowland Dry Ecosystems", "Lowland Mesic Forest & Shrubland", "Lowland Wet Forest & Shrubland", "Montane Wet Forest & Shrubland", "Wetland", "Dry Cliff", "Wet Cliff", "Non-native", "water")
ncols <- length(tnc_ecosystems)
cols=sample(col_vector_random, ncols)
ecosystems_colors <- cols[factor(tnc_before_cut$COMMUNITY, ordered=TRUE, levels=tnc_ecosystems)]
png(filename=paste("Outputs/Env_output_plots/tnc_before_", chosen_island, ".png", sep=""))
plot(tnc_before_cut, col=ecosystems_colors, border=NA, mar = c(2.1,4.1,4.1,10))
title("TNC Ecosystems Before")
legend("bottomright",   # location of legend
legend=tnc_ecosystems,
fill=cols,
inset=c(-.4, 0),
xpd=TRUE,
cex = 0.7)
dev.off()
#CURRENT
if (!file.exists(paste("Data/Environmental_data/TNC Ecosystems Before and Current/Current_Ecosystems_wgs84.shp", sep=""))){
tnc_current <- vect("Data/Environmental_data/TNC Ecosystems Before and Current/Current_Ecosystems.shp")
tnc_current <- project(tnc_current, project_crs)
writeVector(tnc_current, paste("Data/Environmental_data/TNC Ecosystems Before and Current/Current_Ecosystems_wgs84.shp", sep=""), filetype="ESRI Shapefile")
tnc_current_cut <- crop(tnc_current, chosen_map)
tnc_current_snails <- crop(tnc_current, snail_island_shp)
rm(tnc_current)
gc()
} else {
tnc_current <- vect(paste("Data/Environmental_data/TNC Ecosystems Before and Current/Current_Ecosystems_wgs84.shp", sep=""))
tnc_current_cut <- crop(tnc_current, chosen_map)
tnc_current_snails <- crop(tnc_current, snail_island_shp)
rm(tnc_current)
gc()
}
ecosystems_colors <- cols[factor(tnc_current_cut$COMMUNITY, ordered=TRUE, levels=tnc_ecosystems)]
png(filename=paste("Outputs/Env_output_plots/tnc_current_", chosen_island, ".png", sep=""))
plot(tnc_current_cut, col=ecosystems_colors, border=NA, mar = c(2.1,4.1,4.1,10))
title("TNC Ecosystems Current")
legend("bottomright",   # location of legend
legend=tnc_ecosystems,
fill=cols,
inset=c(-.4, 0),
xpd=TRUE,
cex = 0.7)
dev.off()
# Chunk 37
wet_canopy_evaporation <- raster("Data/Environmental_data/Wet Canopy Evaporation/mm/WetCanopyEvaporation_mm_month_raster/wet_canopy_evaporation_mm_month_raster/wce_mm_ann/prj.adf")
#wet_canopy_evaporation <- projectRaster(wet_canopy_evaporation, crs = project_crs)
wet_canopy_evaporation_cut <- mask(wet_canopy_evaporation, chosen_map)
wet_canopy_evaporation_cut <- crop(wet_canopy_evaporation_cut, chosen_map)
wet_canopy_evaporation_snails <- mask(wet_canopy_evaporation, snail_island_shp)
wet_canopy_evaporation_snails <- crop(wet_canopy_evaporation_snails, snail_island_shp)
png(filename=paste("Outputs/Env_output_plots/wet_canopy_evaporation_", chosen_island, ".png", sep=""))
plot(wet_canopy_evaporation_cut)
title("Wet Canopy Evaporation")
dev.off()
# Chunk 38
#wind_speed <- vect("Data/Environmental_data/Wind Speed GIS/30m above ground/Wind_Speed_30m/Wind_Speed_30m.shp")
#wind_speed <- projectRaster(wind_speed, crs = project_crs)
#wind_speed_cut <- terra::intersect(wind_speed, vect(chosen_map))
#wind_speed_cut <- crop(wind_speed_cut, chosen_map)
#ncols <- length(unique(wind_speed_cut$speed_mps))
#cols <- col_vector_ordered(ncols)
#wind_colors <- cols[factor(wind_speed_cut$speed_mps, ordered = TRUE)]
#png(filename=paste("Outputs/Env_output_plots/wind_speed_", chosen_island, ".png", sep=""))
#plot(wind_speed_cut, col=wind_colors)
#lines(chosen_map)
#title("Wind Speed")
#legend("right",   # location of legend
#      legend=sort(unique(wind_speed_cut$speed_mps)),
#      fill=cols,
#      cex=0.6)
#dev.off()
# Chunk 39
snail_data_sf_filtered <- snail_data_sf %>%
filter(coordinateUncertaintyInMeters <= 1000) %>%  # Remove points with an uncertainty of higher than a number
distinct(geometry, .keep_all = TRUE)  # Keep only distinct points based on geometry (lat and long)
#change points to polygons with uncertainty
snail_data_sf_uncertainty <- st_buffer(snail_data_sf_filtered, snail_data_sf_filtered$coordinateUncertaintyInMeters)
# Chunk 40
# Create lists of data
env_rasters_qual <- c(actual_evapotranspiration_cut = actual_evapotranspiration_cut,
available_soil_moisture_cut = available_soil_moisture_cut,
annual_mean_temperature_cut = annual_mean_temperature_cut,
mean_diurnal_range_cut = mean_diurnal_range_cut,
isothermality_cut = isothermality_cut,
temperature_seasonality_cut = temperature_seasonality_cut,
max_temperature_cut = max_temperature_cut,
min_temperature_cut = min_temperature_cut,
annual_temperature_range_cut = annual_temperature_range_cut,
temperature_wet_cut = temperature_wet_cut,
temperature_dry_cut = temperature_dry_cut,
temperature_warm_cut = temperature_warm_cut,
temperature_cold_cut = temperature_cold_cut,
precipitation_cut = precipitation_cut,
precipitation_wet_cut = precipitation_wet_cut,
precipitation_dry_cut = precipitation_dry_cut,
precipitation_seasonality_cut = precipitation_seasonality_cut,
precipitation_warm_cut = precipitation_warm_cut,
precipitation_cold_cut = precipitation_cold_cut,
canopy_wetness_fraction_cut = canopy_wetness_fraction_cut,
cloud_frequency_cut = cloud_frequency_cut,
elevation_cut = elevation_cut,
existing_vegetation_cover_cut = existing_vegetation_cover_cut,
existing_vegetation_height_cut = existing_vegetation_height_cut,
fog_cover_cut = fog_cover_cut,
forest_canopy_base_height_cut = forest_canopy_base_height_cut,
forest_canopy_bulk_density_cut = forest_canopy_bulk_density_cut,
forest_canopy_cover_cut = forest_canopy_cover_cut,
forest_canopy_height_cut = forest_canopy_height_cut,
leaf_area_index_cut = leaf_area_index_cut,
relative_humidity_cut = relative_humidity_cut,
slope_degrees_cut = slope_degrees_cut,
slope_percent_rise_cut = slope_percent_rise_cut,
soil_evaporation_cut = soil_evaporation_cut,
wet_canopy_evaporation_cut = wet_canopy_evaporation_cut
)
env_rasters_class <- c(existing_vegetation_type_cut = existing_vegetation_type_cut)
env_shapes_qual <- c(soil_nutrient_holding_capacity_cut = soil_nutrient_holding_capacity_cut,
soil_organic_matter_cut = soil_organic_matter_cut,
soil_ph_cut = soil_ph_cut,
soil_shrink_and_swell_cut = soil_shrink_and_swell_cut,
soil_water_permeability_cut = soil_water_permeability_cut
)
env_shapes_class <- c(soil_fertility_class_cut = soil_fertility_class_cut,
tnc_before_cut = tnc_before_cut,
tnc_current_cut = tnc_current_cut)
#wind_speed_cut
# Chunk 41
env_rasters_qual_snails <- c(actual_evapotranspiration_snails = actual_evapotranspiration_snails,
available_soil_moisture_snails = available_soil_moisture_snails,
annual_mean_temperature_snails = annual_mean_temperature_snails,
mean_diurnal_range_snails = mean_diurnal_range_snails,
isothermality_snails = isothermality_snails,
temperature_seasonality_snails = temperature_seasonality_snails,
max_temperature_snails = max_temperature_snails,
min_temperature_snails = min_temperature_snails,
annual_temperature_range_snails = annual_temperature_range_snails,
temperature_wet_snails = temperature_wet_snails,
temperature_dry_snails = temperature_dry_snails,
temperature_warm_snails = temperature_warm_snails,
temperature_cold_snails = temperature_cold_snails,
precipitation_snails = precipitation_snails,
precipitation_wet_snails = precipitation_wet_snails,
precipitation_dry_snails = precipitation_dry_snails,
precipitation_seasonality_snails = precipitation_seasonality_snails,
precipitation_warm_snails = precipitation_warm_snails,
precipitation_cold_snails = precipitation_cold_snails,
canopy_wetness_fraction_snails = canopy_wetness_fraction_snails,
cloud_frequency_snails = cloud_frequency_snails,
elevation_snails = elevation_snails,
existing_vegetation_cover_snails = existing_vegetation_cover_snails,
existing_vegetation_height_snails = existing_vegetation_height_snails,
fog_cover_snails = fog_cover_snails,
forest_canopy_base_height_snails = forest_canopy_base_height_snails,
forest_canopy_bulk_density_snails = forest_canopy_bulk_density_snails,
forest_canopy_cover_snails = forest_canopy_cover_snails,
forest_canopy_height_snails = forest_canopy_height_snails,
leaf_area_index_snails = leaf_area_index_snails,
relative_humidity_snails = relative_humidity_snails,
slope_degrees_snails = slope_degrees_snails,
slope_percent_rise_snails = slope_percent_rise_snails,
soil_evaporation_snails = soil_evaporation_snails,
wet_canopy_evaporation_snails = wet_canopy_evaporation_snails
)
env_rasters_class_snails <- c(existing_vegetation_type_snails = existing_vegetation_type_snails)
env_shapes_qual_snails <- c(soil_nutrient_holding_capacity_snails = soil_nutrient_holding_capacity_snails,
soil_organic_matter_snails = soil_organic_matter_snails,
soil_ph_snails = soil_ph_snails,
soil_shrink_and_swell_snails = soil_shrink_and_swell_snails,
soil_water_permeability_snails = soil_water_permeability_snails
)
env_shapes_class_snails <- c(soil_fertility_class_snails = soil_fertility_class_snails,
tnc_before_snails = tnc_before_snails,
tnc_current_snails = tnc_current_snails)
#wind_speed_snails
# Chunk 42
#env_rasters_qual
snail_env_data <- data.frame()
assign("snail_env_data", TRUE, env=globalenv())
tryCatch ({
env_values <- as.data.frame(lapply(env_rasters_qual_snails, function(raster) {
extract(raster, snail_data_sf_uncertainty, method = "simple", fun = mean)
}))
snail_env_data <- cbind(snail_data_sf_uncertainty, env_values)
}, error = function(e) {
assign("snail_env_data", snail_data_sf_uncertainty, env=globalenv())
})
#env_rasters_class
#env_shapes_qual
#extract(soil_nutrient_holding_capacity_cut[,11], vect(snail_data_sf_uncertainty))
#env_shapes_class
# Chunk 43
#env_rasters_qual
exclosures_env_data <- data.frame()
assign("exclosures_env_data", TRUE, env=globalenv())
tryCatch ({
env_values <- as.data.frame(lapply(env_rasters_qual, function(raster) {
extract(raster, exclosure_data_sf, method = "simple", fun = mean)
}))
exclosures_env_data <- cbind(exclosure_data_sf, env_values)
}, error = function(e) {
assign("exclosures_env_data", exclosure_data_sf, env=globalenv())
})
#env_rasters_class
#env_shapes_qual
#env_shapes_class
# note this only works when all occurrences are on one island
plots_list <- vector("list", length = length(env_rasters_qual))
group <- toTitleCase(chosen_island)
for (i in seq_along(plots_list)) {
filename=paste("Outputs/1D_plots/", names(env_rasters_qual[i]), "_", chosen_island, ".jpg", sep="")
col_name <- names(env_rasters_qual[i])
all_cut_data <- data.frame(as.data.frame(get(col_name)), group=group)
if(ncol(snail_env_data) > 14){
micans_data <- data.frame(as.data.frame(snail_env_data[i+13])[,1], group="Amastra micans")
colnames(micans_data) <- colnames(all_cut_data)
comb_data <- rbind(all_cut_data, micans_data)
comb_data <- comb_data[complete.cases(comb_data), ]
plots_list[[i]] <- ggplot(comb_data, aes(x = .data[[colnames(as.data.frame(get(col_name)))]])) +
geom_histogram(aes(y = ..ncount.., fill=group, color=group), bins = 40, alpha = 0.6, position = "identity") +
geom_vline(xintercept = as.data.frame(exclosures_env_data[, i+2])[,1],
color = "red", linetype = "solid", linewidth = .5) +
geom_text(data = data.frame(x = as.data.frame(exclosures_env_data[, i+2])[,1],
label = as.data.frame(exclosures_env_data[, 2])[,1]),
aes(x = x, y=0, label = label), vjust = -0.5, hjust = 0, color = "black", angle = 90, size = 3.5) +
labs(title = paste(names(env_rasters_qual[i]), "_", chosen_island, sep=""),
x = names(env_rasters_qual[i]),
y = "Scaled Density") +
xlim(c(env_rasters_qual[i][[names(env_rasters_qual[i])]]@data@min, env_rasters_qual[i][[names(env_rasters_qual[i])]]@data@max)) +
theme_minimal()
} else {
comb_data <- all_cut_data
comb_data <- comb_data[complete.cases(comb_data), ]
plots_list[[i]] <- ggplot(comb_data, aes(x = .data[[colnames(as.data.frame(get(col_name)))]])) +
geom_histogram(aes(y = ..ncount..), bins = 40, alpha = 0.6, position = "identity", color="#01bdc3", fill="#66d9dc") +
labs(title = paste(names(env_rasters_qual[i]), "_", chosen_island, sep=""),
x = names(env_rasters_qual[i]),
y = "Scaled Density") +
xlim(c(env_rasters_qual[i][[names(env_rasters_qual[i])]]@data@min, env_rasters_qual[i][[names(env_rasters_qual[i])]]@data@max)) +
theme_minimal()
}
ggsave(filename, plots_list[[i]], device = "jpg", dpi = 300, width = 3184, height = 1959, units = "px")
}
#plot_grid(plotlist = plots_list[1:8], nrow = 4, align = "h")
#plot_grid(plotlist = plots_list[9:16], nrow = 4, align = "h")
#plot_grid(plotlist = plots_list[17:24], nrow = 4, align = "h")
#plot_grid(plotlist = plots_list[25:32], nrow = 4, align = "h")
#plot_grid(plotlist = plots_list[33:35], nrow = 3, align = "h")
